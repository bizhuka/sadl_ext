<?xml version="1.0" encoding="utf-8"?>
<abapGit version="v1.0.0" serializer="LCL_OBJECT_ENHO" serializer_version="v1.0.0">
 <asx:abap xmlns:asx="http://www.sap.com/abapxml" version="1.0">
  <asx:values>
   <TOOL>HOOK_IMPL</TOOL>
   <SHORTTEXT>Call ZIF_SADL_PREPARE_BATCH-&gt;prepare()</SHORTTEXT>
   <ORIGINAL_OBJECT>
    <PGMID>R3TR</PGMID>
    <ORG_OBJ_TYPE>CLAS</ORG_OBJ_TYPE>
    <ORG_OBJ_NAME>CL_SADL_GW_GENERIC_DPC</ORG_OBJ_NAME>
    <ORG_MAIN_TYPE>CLAS</ORG_MAIN_TYPE>
    <ORG_MAIN_NAME>CL_SADL_GW_GENERIC_DPC</ORG_MAIN_NAME>
    <PROGRAMNAME>CL_SADL_GW_GENERIC_DPC========CP</PROGRAMNAME>
   </ORIGINAL_OBJECT>
   <ENHANCEMENTS>
    <ENH_HOOK_IMPL>
     <PROGRAMNAME>CL_SADL_GW_GENERIC_DPC========CP</PROGRAMNAME>
     <ENHMODE>D</ENHMODE>
     <FULL_NAME>\TY:CL_SADL_GW_GENERIC_DPC\ME:PREPROCESS_BATCH\SE:END\EI</FULL_NAME>
     <SOURCE>
      <item/>
      <item>CHECK mo_mdp      IS NOT INITIAL</item>
      <item>AND mo_sadl_api IS NOT INITIAL</item>
      <item>AND mr_service_document_name IS NOT INITIAL</item>
      <item>AND mr_service_document_name-&gt;* CP &apos;Z*_CDS&apos;.</item>
      <item>DATA(lv_zabap_len)    = strlen( mr_service_document_name-&gt;* ) - 4.</item>
      <item>DATA(lv_zabap_prefix) = |CDS_{ mr_service_document_name-&gt;*(lv_zabap_len) }|.</item>
      <item/>
      <item>DATA lt_zabap_entities TYPE SORTED TABLE OF sadl_entity_id WITH UNIQUE KEY table_line.</item>
      <item>LOOP AT et_create ASSIGNING FIELD-SYMBOL(&lt;ls_create&gt;).</item>
      <item>INSERT &lt;ls_create&gt;-entity_id INTO TABLE lt_zabap_entities.</item>
      <item>ENDLOOP.</item>
      <item>LOOP AT et_update ASSIGNING FIELD-SYMBOL(&lt;ls_update&gt;).</item>
      <item>INSERT &lt;ls_update&gt;-entity_id INTO TABLE lt_zabap_entities.</item>
      <item>ENDLOOP.</item>
      <item>LOOP AT et_delete ASSIGNING FIELD-SYMBOL(&lt;ls_delete&gt;).</item>
      <item>INSERT &lt;ls_delete&gt;-entity_id INTO TABLE lt_zabap_entities.</item>
      <item>ENDLOOP.</item>
      <item>LOOP AT et_action ASSIGNING FIELD-SYMBOL(&lt;ls_action&gt;).</item>
      <item>INSERT &lt;ls_action&gt;-entity_id INTO TABLE lt_zabap_entities.</item>
      <item>ENDLOOP.</item>
      <item/>
      <item>LOOP AT lt_zabap_entities ASSIGNING FIELD-SYMBOL(&lt;lv_zabap_entity&gt;).</item>
      <item>TRY.</item>
      <item>DATA(ls_zabap_load) = mo_mdp-&gt;get_entity_load_by_id( |{ lv_zabap_prefix }~{ &lt;lv_zabap_entity&gt; }| ).</item>
      <item>CATCH cx_sadl_contract_violation.</item>
      <item>CLEAR ls_zabap_load.</item>
      <item>ENDTRY.</item>
      <item>CHECK ls_zabap_load IS NOT INITIAL.</item>
      <item/>
      <item>ASSIGN ls_zabap_load-&gt;sadl_entity-cds_entity_annotations[ annoname = zcl_sadl_annotation_ext=&gt;id ] TO FIELD-SYMBOL(&lt;ls_zabap_anno&gt;).</item>
      <item>CHECK sy-subrc = 0.</item>
      <item/>
      <item>DATA(lo_sadl_exit) = zcl_sadl_annotation_ext=&gt;create( &lt;ls_zabap_anno&gt;-value ).</item>
      <item>CHECK lo_sadl_exit IS NOT INITIAL</item>
      <item>AND lo_sadl_exit IS INSTANCE OF zif_sadl_prepare_batch.</item>
      <item/>
      <item>CAST zif_sadl_prepare_batch( lo_sadl_exit</item>
      <item>)-&gt;prepare( EXPORTING iv_node_name         = ls_zabap_load-&gt;sadl_entity-node_name</item>
      <item>it_changeset_request = it_changeset_request</item>
      <item>CHANGING  ct_update            = et_update</item>
      <item>ct_create            = et_create</item>
      <item>ct_delete            = et_delete</item>
      <item>ct_action            = et_action ).</item>
      <item>ENDLOOP.</item>
     </SOURCE>
    </ENH_HOOK_IMPL>
   </ENHANCEMENTS>
   <SPACES>
    <item>
     <FULL_NAME>\TY:CL_SADL_GW_GENERIC_DPC\ME:PREPROCESS_BATCH\SE:END\EI</FULL_NAME>
     <SPACES>
      <item>0</item>
      <item>3</item>
      <item>5</item>
      <item>5</item>
      <item>5</item>
      <item>3</item>
      <item>3</item>
      <item>0</item>
      <item>3</item>
      <item>3</item>
      <item>5</item>
      <item>3</item>
      <item>3</item>
      <item>5</item>
      <item>3</item>
      <item>3</item>
      <item>5</item>
      <item>3</item>
      <item>3</item>
      <item>5</item>
      <item>3</item>
      <item>0</item>
      <item>3</item>
      <item>5</item>
      <item>9</item>
      <item>7</item>
      <item>9</item>
      <item>5</item>
      <item>5</item>
      <item>0</item>
      <item>5</item>
      <item>5</item>
      <item>0</item>
      <item>5</item>
      <item>5</item>
      <item>7</item>
      <item>0</item>
      <item>5</item>
      <item>18</item>
      <item>40</item>
      <item>30</item>
      <item>40</item>
      <item>40</item>
      <item>40</item>
      <item>3</item>
     </SPACES>
    </item>
   </SPACES>
  </asx:values>
 </asx:abap>
</abapGit>
